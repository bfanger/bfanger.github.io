import"../chunks/DsnmJJEf.js";import{k as E,l as xe,j as je,a_ as Z,H as ke,q as Ie,v as Pe,w as J,a0 as Q,X as O,F as V,z as R,W as Ee,x as He,a$ as ee,b0 as te,b1 as re,b2 as Te,K as ae,L as q,aH as Ae,a1 as Ne,a3 as Ce,a2 as $e,b3 as Le,aj as Oe,p as N,f as M,ao as Re,t as ue,i as z,a as C,g as r,u as y,ap as qe,c as fe,d as U,n as F,r as de,ac as se,ak as Be,an as H,b as k,a6 as De,s as ne,aL as A}from"../chunks/M1qROfWy.js";import{i as oe}from"../chunks/BP2hkfCR.js";import{e as Ye}from"../chunks/CZK83E-6.js";import{p as Me,a as ve,s as _e}from"../chunks/BLle4rFf.js";import{p as Ue}from"../chunks/DG6MVhOd.js";import{P as B}from"../chunks/7Hh4xBnI.js";import{o as Fe}from"../chunks/CaTcOTgH.js";import{s as me}from"../chunks/CJZPip-Q.js";import{w as he}from"../chunks/DWvuQjhu.js";const D=0,T=1,Y=2;function Ge(n,t,o,c,v){E&&xe();var a=n,u=Te,i=Q,f,l,m,w=V(void 0),e=V(void 0),h=!1;function g(b,p){h=!0,p&&(ee(_),te(_),re(u));try{b===D&&o&&(f?ae(f):f=R(()=>o(a))),b===T&&c&&(l?ae(l):l=R(()=>c(a,w))),b!==D&&f&&q(f,()=>f=null),b!==T&&l&&q(l,()=>l=null),b!==Y&&m&&q(m,()=>m=null)}finally{p&&(re(null),te(null),ee(null),Ae())}}var _=je(()=>{if(i===(i=t()))return;let b=E&&Z(i)===(a.data===ke);if(b&&(a=Ie(),Pe(a),J(!1),b=!0),Z(i)){var p=i;h=!1,p.then(x=>{p===i&&(O(w,x),g(T,!0))},x=>{if(p===i)throw O(e,x),g(Y,!0),e.v}),E?o&&(f=R(()=>o(a))):Ee(()=>{h||g(D,!0)})}else O(w,i),g(T,!1);return b&&J(!0),()=>i=Q});E&&(a=He)}function Ke(n,t,o){Ne(()=>{var c=Ce(()=>t(n,o?.())||{});if(o&&c?.update){var v=!1,a={};$e(()=>{var u=o();Le(u),v&&Oe(a,u)&&(a=u,c.update(u))}),v=!0}if(c?.destroy)return()=>c.destroy()})}var We=M('<div class="scroller"></div>');function Xe(n,t){N(t,!0);let o=Me(t,"value",15),c=y(()=>t.max);o()!==0&&Fe(()=>{window.scrollTo(0,document.body.scrollHeight*(o()/r(c)))});function v(){const i=window.scrollY/(document.body.offsetHeight-window.innerHeight);o(i*r(c))}var a=We();Re("scroll",qe,v);let u;ue(i=>u=me(a,"",u,i),[()=>({height:`${r(c)*100}vh`})]),z(n,a),C()}function Ze(n,t){let o=ie(t),c,v,a=!0;function u({box:f}){c=new ResizeObserver(([l])=>{let m;f==="border-box"?m=l.borderBoxSize:f==="device-pixel-content-box"?m=l.devicePixelContentBoxSize:m=l.contentBoxSize,o.set(Array.isArray(m)?m[0]:m),a=!1}),c.observe(n,{box:f}),v=o.subscribe(l=>{a||n.dispatchEvent(new CustomEvent("has-resized",{detail:l}))})}function i(){c.disconnect(),v()}return u(le(t)),{update(f){a=!0,o=ie(f),i(),u(le(f))},destroy(){i()}}}function ie(n){if(typeof n=="object"){if(n.subscribe)return n;if(n.store)return n.store}return he({inlineSize:0,blockSize:0})}function le(n){if(typeof n>"u"||n.subscribe)return{};const{store:t,...o}=n;return o}var Je=M('<div class="item svelte-1g87s5s"><!></div>');function ce(n,t){N(t,!0);const o=()=>ve(u,"$size",c),[c,v]=_e(),a=16,u=he({inlineSize:0,blockSize:0});function i(e,h){const g=window.innerHeight,_=g/2;if(e>1)return-h;if(e<-1)return g;if(e>.5){const p=(e-.5)*2;return-h+_-_*p}if(e<-.5){const p=(e+1.5)*2-1;return g-_*p}const b=e+.5;return _-h*b}function f(e,h){if(h===0)return"";let g=1;if(e>.75&&e<1){const _=(e-.75)*4;g=1-_*_*.2}if(e<-.5&&e>-1){const _=(e+.5)*-2;g=1-_*_*.3}return`translateY(${i(e,h+a)}px) scale(${g})`}var l=Je();let m;var w=fe(l);U(w,()=>t.children??F),de(l),Ke(l,(e,h)=>Ze?.(e,h),()=>u),ue(e=>m=me(l,"",m,e),[()=>({transform:f(t.scroll,o().blockSize)})]),z(n,l),C(),v()}var Qe=M('<!> <div class="viewport svelte-105t3g3"><!> <!></div>',1);function Ve(n,t){N(t,!0);const o=()=>ve(Ue,"$page",c),[c,v]=_e(),a=f(o().params.project),u=se({});let i=Be(se(a));function f(s){return t.teasers.findIndex(d=>d.slug===s)}function l(s){const d=f(s);return u[d]||(u[d]=fetch(`/projects/${s}.json`).then(S=>S.json())),u[d]}function m(s){const{slug:d}=t.teasers[s],S=`/scrollytelling/${d}`;window.location.pathname!==S&&window.history.pushState({scroll:s},"",`/scrollytelling/${d}`)}function w(s){return{content:"",released:s.released,slug:s.slug,title:s.title}}let e=y(()=>Math.round(r(i))),h=y(()=>t.teasers[r(e)-1]?.slug),g=y(()=>t.teasers[r(e)]?.slug),_=y(()=>t.teasers[r(e)+1]?.slug);H(()=>{r(h)&&l(r(h))}),H(()=>{r(g)&&l(r(g))}),H(()=>{r(_)&&l(r(_))});let b=y(()=>[r(e)-1,r(e),r(e)+1].filter(s=>s>=0&&s<t.teasers.length&&s!==a));H(()=>{m(r(e))});var p=Qe(),x=k(p);{let s=y(()=>t.teasers.length-1);Xe(x,{get max(){return r(s)},get value(){return r(i)},set value(d){De(i,d,!0)}})}var G=ne(x,2),K=fe(G);Ye(K,16,()=>r(b),s=>s,(s,d)=>{{let S=y(()=>r(i)-d);ce(s,{get scroll(){return r(S)},children:(W,$)=>{var I=A(),pe=k(I);Ge(pe,()=>u[d],L=>{{let P=y(()=>w(t.teasers[d]));B(L,{get project(){return r(P)}})}},(L,P)=>{var X=A(),ye=k(X);{var we=j=>{B(j,{get project(){return r(P)}})},Se=j=>{{let ze=y(()=>w(t.teasers[d]));B(j,{get project(){return r(ze)}})}};oe(ye,j=>{r(P)?j(we):j(Se,!1)})}z(L,X)}),z(W,I)},$$slots:{default:!0}})}});var ge=ne(K,2);{var be=s=>{{let d=y(()=>r(i)-a);ce(s,{get scroll(){return r(d)},children:(S,W)=>{var $=A(),I=k($);U(I,()=>t.children??F),z(S,$)},$$slots:{default:!0}})}};oe(ge,s=>{a>r(e)-2&&a<r(e)+2&&s(be)})}de(G),z(n,p),C(),v()}function ut(n,t){N(t,!0),Ve(n,{get teasers(){return t.data.teasers},children:(o,c)=>{var v=A(),a=k(v);U(a,()=>t.children??F),z(o,v)},$$slots:{default:!0}}),C()}export{ut as component};
