import{i as B,s as X,h as pe,a as x,t as V,g as be,f as we,k as E}from"../chunks/disclose-version.CKw3xYd0.js";import{h as N,j as ye,b as xe,aS as Se,v as k,x as ze,q as je,ad as Z,ac as $,aT as ee,u as R,w as U,a2 as Pe,U as ke,R as Ie,P as Ce,S as Ee,aU as He,O as Oe,t as ie,p as H,a as O,a0 as Te,g as n,d as b,c as oe,n as F,r as ce,V as I,f as z,s as te}from"../chunks/runtime.BHyXe1IG.js";import{s as J}from"../chunks/snippet.BBFuUJq1.js";import{i as re}from"../chunks/7.7yJTnkf0.js";import{e as qe}from"../chunks/each.CgXmvzV1.js";import{p as Ae,s as le,a as ue,d as M}from"../chunks/props.CVWM3abs.js";import{p as Be}from"../chunks/stores.DOY-a8H9.js";import{P as Y}from"../chunks/ProjectCard.DMssrN5o.js";import{o as Ne}from"../chunks/index-client.S3Y0OLud.js";import{w as fe}from"../chunks/index.BPUafzCz.js";const D=0,C=1,G=2;function Re(a,e,r,o,c){N&&ye();var i=a,u=ke,h,l,_,f,s=X(void 0),m=X(void 0),p=!1;function d(v,w){p=!0,w&&(Z(S),$(S),ee(u));try{v===D&&r&&(l?R(l):l=k(()=>r(i))),v===C&&o&&(_?R(_):_=k(()=>o(i,s))),v===G&&c&&(f?R(f):f=k(()=>c(i,m))),v!==D&&l&&U(l,()=>l=null),v!==C&&_&&U(_,()=>_=null),v!==G&&f&&U(f,()=>f=null)}finally{w&&(ee(null),$(null),Z(null),Pe())}}var S=xe(()=>{if(h!==(h=e())){if(Se(h)){var v=h;p=!1,v.then(w=>{v===h&&(B(s,w),d(C,!0))},w=>{if(v===h)throw B(m,w),d(G,!0),m.v}),N?r&&(l=k(()=>r(i))):ze(()=>{p||d(D,!0)})}else B(s,h),d(C,!1);return()=>h=null}});N&&(i=je)}function Ue(a,e,r){Ie(()=>{var o=Ce(()=>e(a,r==null?void 0:r())||{});if(r&&(o!=null&&o.update)){var c=!1,i={};Ee(()=>{var u=r();He(u),c&&Oe(i,u)&&(i=u,o.update(u))}),c=!0}if(o!=null&&o.destroy)return()=>o.destroy()})}function de(a,e,r,o){var c=a.__styles??(a.__styles={});c[e]!==r&&(c[e]=r,r==null?a.style.removeProperty(e):a.style.setProperty(e,r,""))}var Me=V('<div class="scroller"></div>');function Ye(a,e){O(e,!0);let r=Ae(e,"value",15),o=b(()=>e.max);r()!==0&&Ne(()=>{window.scrollTo(0,document.body.scrollHeight*(r()/n(o)))});function c(){const u=window.scrollY/(document.body.offsetHeight-window.innerHeight);r(u*n(o))}var i=Me();pe("scroll",Te,c),ie(()=>de(i,"height",`${n(o)*100}vh`)),x(a,i),H()}function De(a,e){let r=se(e),o,c,i=!0;function u({box:l}){o=new ResizeObserver(([_])=>{let f;l==="border-box"?f=_.borderBoxSize:l==="device-pixel-content-box"?f=_.devicePixelContentBoxSize:f=_.contentBoxSize,r.set(Array.isArray(f)?f[0]:f),i=!1}),o.observe(a,{box:l}),c=r.subscribe(_=>{i||a.dispatchEvent(new CustomEvent("has-resized",{detail:_}))})}function h(){o.disconnect(),c()}return u(ne(e)),{update(l){i=!0,r=se(l),h(),u(ne(l))},destroy(){h()}}}function se(a){if(typeof a=="object"){if(a.subscribe)return a;if(a.store)return a.store}return fe({inlineSize:0,blockSize:0})}function ne(a){if(typeof a>"u"||a.subscribe)return{};const{store:e,...r}=a;return r}var Ge=V('<div class="item svelte-hrs2h8"><!></div>');function ae(a,e){O(e,!0);const r=le(),o=()=>ue(i,"$size",r),c=16,i=fe({inlineSize:0,blockSize:0});function u(s,m){const p=window.innerHeight,d=p/2;if(s>1)return-m;if(s<-1)return p;if(s>.5){const v=(s-.5)*2;return-m+d-d*v}if(s<-.5){const v=(s+1.5)*2-1;return p-d*v}const S=s+.5;return d-m*S}function h(s,m){if(m===0)return"";let p=1;if(s>.75&&s<1){const d=(s-.75)*4;p=1-d*d*.2}if(s<-.5&&s>-1){const d=(s+.5)*-2;p=1-d*d*.3}return`translateY(${u(s,m+c)}px) scale(${p})`}var l=Ge();const _=b(()=>h(e.scroll,o().blockSize));ie(()=>de(l,"transform",n(_)));var f=oe(l);J(f,()=>e.children??F),ce(l),Ue(l,(s,m)=>De(s,m),()=>i),x(a,l),H()}var Ve=V('<!> <div class="viewport svelte-1hdbnwf"><!> <!></div>',1);function Fe(a,e){O(e,!0);const r=le(),c=h(ue(Be,"$page",r).params.project),i=M({});let u=be(M(c));function h(t){return e.teasers.findIndex(g=>g.slug===t)}function l(t){const g=h(t);return i[g]||(i[g]=fetch(`/projects/${t}.json`).then(y=>y.json())),i[g]}function _(t){const{slug:g}=e.teasers[t],y=`/scrollytelling/${g}`;window.location.pathname!==y&&window.history.pushState({scroll:t},"",`/scrollytelling/${g}`)}function f(t){return{content:"",released:t.released,slug:t.slug,title:t.title}}let s=b(()=>Math.round(n(u))),m=b(()=>{var t;return(t=e.teasers[n(s)-1])==null?void 0:t.slug}),p=b(()=>{var t;return(t=e.teasers[n(s)])==null?void 0:t.slug}),d=b(()=>{var t;return(t=e.teasers[n(s)+1])==null?void 0:t.slug});I(()=>{n(m)&&l(n(m))}),I(()=>{n(p)&&l(n(p))}),I(()=>{n(d)&&l(n(d))});let S=b(()=>[n(s)-1,n(s),n(s)+1].filter(t=>t>=0&&t<e.teasers.length&&t!==c));I(()=>{_(n(s))});var v=Ve(),w=z(v),ve=b(()=>e.teasers.length-1);Ye(w,{get max(){return n(ve)},get value(){return n(u)},set value(t){we(u,M(t))}});var K=te(w,2),L=oe(K);qe(L,16,()=>n(S),t=>t,(t,g)=>{var y=b(()=>n(u)-g);ae(t,{get scroll(){return n(y)},children:(Q,T)=>{var j=E(),_e=z(j);Re(_e,()=>i[g],q=>{var P=b(()=>f(e.teasers[g]));Y(q,{get project(){return n(P)}})},(q,P)=>{var W=E(),me=z(W);re(me,()=>n(P),A=>{Y(A,{get project(){return n(P)}})},A=>{var ge=b(()=>f(e.teasers[g]));Y(A,{get project(){return n(ge)}})}),x(q,W)}),x(Q,j)},$$slots:{default:!0}})});var he=te(L,2);re(he,()=>c>n(s)-2&&c<n(s)+2,t=>{var g=b(()=>n(u)-c);ae(t,{get scroll(){return n(g)},children:(y,Q)=>{var T=E(),j=z(T);J(j,()=>e.children??F),x(y,T)},$$slots:{default:!0}})}),ce(K),x(a,v),H()}function rt(a,e){O(e,!0),Fe(a,{get teasers(){return e.data.teasers},children:(r,o)=>{var c=E(),i=z(c);J(i,()=>e.children??F),x(r,c)},$$slots:{default:!0}}),H()}export{rt as component};
