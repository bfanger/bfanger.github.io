import{t as G,a as S,c as N}from"../chunks/D303kT0h.js";import{h as T,d as je,b as ke,aH as Q,H as Pe,i as Te,j as Ee,k as V,a5 as $,O as q,z as ee,q as B,N as He,l as Ne,ak as te,aj as re,aI as se,X as Ae,o as ne,v as D,ac as Ce,R as Oe,T as Re,S as qe,aJ as Be,a1 as De,p as A,t as fe,a as C,g as s,u as y,a6 as Ye,c as de,n as J,r as ve,ag as ae,a2 as Le,W as E,f as j,a3 as Me,s as oe}from"../chunks/BT0z8Yw2.js";import{s as W}from"../chunks/lIS-YuR3.js";import{i as ie}from"../chunks/CTQejzkj.js";import{e as Ue}from"../chunks/asrYo287.js";import{p as Ge,f as Je,a as me,s as _e}from"../chunks/CFCplBPZ.js";import{p as We}from"../chunks/CGx3xgRt.js";import{P as Y}from"../chunks/hB80eUvU.js";import{s as he}from"../chunks/DlEUdvuJ.js";import{o as Xe}from"../chunks/Cna6jh3n.js";import{w as ge}from"../chunks/Cjgm01Uw.js";const L=0,H=1,M=2;function Ze(o,r,a,i,v){T&&je();var n=o,u=Ae,c=$,f,l,m,w=ee(void 0),t=ee(void 0),_=!1;function h(p,b){_=!0,b&&(te(d),re(d),se(u));try{p===L&&a&&(f?ne(f):f=B(()=>a(n))),p===H&&i&&(l?ne(l):l=B(()=>i(n,w))),p!==L&&f&&D(f,()=>f=null),p!==H&&l&&D(l,()=>l=null),p!==M&&m&&D(m,()=>m=null)}finally{b&&(se(null),re(null),te(null),Ce())}}var d=ke(()=>{if(c===(c=r()))return;let p=T&&Q(c)===(n.data===Pe);if(p&&(n=Te(),Ee(n),V(!1),p=!0),Q(c)){var b=c;_=!1,b.then(z=>{b===c&&(q(w,z),h(H,!0))},z=>{if(b===c)throw q(t,z),h(M,!0),t.v}),T?a&&(f=B(()=>a(n))):He(()=>{_||h(L,!0)})}else q(w,c),h(H,!1);return p&&V(!0),()=>c=$});T&&(n=Ne)}function Fe(o,r,a){Oe(()=>{var i=Re(()=>r(o,a==null?void 0:a())||{});if(a&&(i!=null&&i.update)){var v=!1,n={};qe(()=>{var u=a();Be(u),v&&De(n,u)&&(n=u,i.update(u))}),v=!0}if(i!=null&&i.destroy)return()=>i.destroy()})}var Ke=G('<div class="scroller"></div>');function Qe(o,r){A(r,!0);let a=Ge(r,"value",15),i=y(()=>r.max);a()!==0&&Xe(()=>{window.scrollTo(0,document.body.scrollHeight*(a()/s(i)))});function v(){const c=window.scrollY/(document.body.offsetHeight-window.innerHeight);a(c*s(i))}var n=Ke();Je("scroll",Ye,v);let u;fe(()=>u=he(n,"",u,{height:`${s(i)*100}vh`})),S(o,n),C()}function U(o,r){let a=ce(r),i,v,n=!0;function u({box:f}){i=new ResizeObserver(([l])=>{let m;f==="border-box"?m=l.borderBoxSize:f==="device-pixel-content-box"?m=l.devicePixelContentBoxSize:m=l.contentBoxSize,a.set(Array.isArray(m)?m[0]:m),n=!1}),i.observe(o,{box:f}),v=a.subscribe(l=>{n||o.dispatchEvent(new CustomEvent("has-resized",{detail:l}))})}function c(){i.disconnect(),v()}return u(le(r)),{update(f){n=!0,a=ce(f),c(),u(le(f))},destroy(){c()}}}function ce(o){if(typeof o=="object"){if(o.subscribe)return o;if(o.store)return o.store}return ge({inlineSize:0,blockSize:0})}function le(o){if(typeof o>"u"||o.subscribe)return{};const{store:r,...a}=o;return a}var Ve=G('<div class="item svelte-hrs2h8"><!></div>');function ue(o,r){A(r,!0);const[a,i]=_e(),v=()=>me(u,"$size",a),n=16,u=ge({inlineSize:0,blockSize:0});function c(t,_){const h=window.innerHeight,d=h/2;if(t>1)return-_;if(t<-1)return h;if(t>.5){const b=(t-.5)*2;return-_+d-d*b}if(t<-.5){const b=(t+1.5)*2-1;return h-d*b}const p=t+.5;return d-_*p}function f(t,_){if(_===0)return"";let h=1;if(t>.75&&t<1){const d=(t-.75)*4;h=1-d*d*.2}if(t<-.5&&t>-1){const d=(t+.5)*-2;h=1-d*d*.3}return`translateY(${c(t,_+n)}px) scale(${h})`}var l=Ve();let m;var w=de(l);W(w,()=>r.children??J),ve(l),Fe(l,(t,_)=>U==null?void 0:U(t,_),()=>u),fe(t=>m=he(l,"",m,{transform:t}),[()=>f(r.scroll,v().blockSize)]),S(o,l),C(),i()}var $e=G('<!> <div class="viewport svelte-1hdbnwf"><!> <!></div>',1);function et(o,r){A(r,!0);const[a,i]=_e(),n=f(me(We,"$page",a).params.project),u=ae({});let c=Le(ae(n));function f(e){return r.teasers.findIndex(g=>g.slug===e)}function l(e){const g=f(e);return u[g]||(u[g]=fetch(`/projects/${e}.json`).then(x=>x.json())),u[g]}function m(e){const{slug:g}=r.teasers[e],x=`/scrollytelling/${g}`;window.location.pathname!==x&&window.history.pushState({scroll:e},"",`/scrollytelling/${g}`)}function w(e){return{content:"",released:e.released,slug:e.slug,title:e.title}}let t=y(()=>Math.round(s(c))),_=y(()=>{var e;return(e=r.teasers[s(t)-1])==null?void 0:e.slug}),h=y(()=>{var e;return(e=r.teasers[s(t)])==null?void 0:e.slug}),d=y(()=>{var e;return(e=r.teasers[s(t)+1])==null?void 0:e.slug});E(()=>{s(_)&&l(s(_))}),E(()=>{s(h)&&l(s(h))}),E(()=>{s(d)&&l(s(d))});let p=y(()=>[s(t)-1,s(t),s(t)+1].filter(e=>e>=0&&e<r.teasers.length&&e!==n));E(()=>{m(s(t))});var b=$e(),z=j(b);const pe=y(()=>r.teasers.length-1);Qe(z,{get max(){return s(pe)},get value(){return s(c)},set value(e){Me(c,e,!0)}});var X=oe(z,2),Z=de(X);Ue(Z,16,()=>s(p),e=>e,(e,g)=>{const x=y(()=>s(c)-g);ue(e,{get scroll(){return s(x)},children:(F,O)=>{var k=N(),we=j(k);Ze(we,()=>u[g],R=>{const P=y(()=>w(r.teasers[g]));Y(R,{get project(){return s(P)}})},(R,P)=>{var K=N(),xe=j(K);{var Se=I=>{Y(I,{get project(){return s(P)}})},ze=I=>{const Ie=y(()=>w(r.teasers[g]));Y(I,{get project(){return s(Ie)}})};ie(xe,I=>{s(P)?I(Se):I(ze,!1)})}S(R,K)}),S(F,k)},$$slots:{default:!0}})});var be=oe(Z,2);{var ye=e=>{const g=y(()=>s(c)-n);ue(e,{get scroll(){return s(g)},children:(x,F)=>{var O=N(),k=j(O);W(k,()=>r.children??J),S(x,O)},$$slots:{default:!0}})};ie(be,e=>{n>s(t)-2&&n<s(t)+2&&e(ye)})}ve(X),S(o,b),C(),i()}function dt(o,r){A(r,!0),et(o,{get teasers(){return r.data.teasers},children:(a,i)=>{var v=N(),n=j(v);W(n,()=>r.children??J),S(a,v)},$$slots:{default:!0}}),C()}export{dt as component};
