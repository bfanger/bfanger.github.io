import{i as U,s as Q,h as be,a as x,t as G,g as we,f as ye,k as E}from"../chunks/disclose-version.CnWa0IKA.js";import{h as q,j as xe,b as ze,aU as Se,v as P,x as je,_ as X,q as Ie,af as $,ae as ee,aV as te,u as B,w as R,a4 as Pe,U as ke,R as Ce,P as Ee,S as Ne,aW as Ae,O as He,t as oe,p as N,a as A,a1 as Oe,g as n,d as b,c as ce,n as L,r as le,V as k,f as S,s as re}from"../chunks/runtime.CK9pv3y8.js";import{s as W}from"../chunks/snippet.qJ59effM.js";import{i as se}from"../chunks/7.BJm9IHgD.js";import{e as Te}from"../chunks/each.DIlVRnqD.js";import{p as Ue,s as ue,a as fe,d as D}from"../chunks/props.D6HGe6wV.js";import{p as qe}from"../chunks/stores.HvbB-B32.js";import{P as M}from"../chunks/ProjectCard.D5dMqpE1.js";import{o as Be}from"../chunks/index-client.DmKowFcd.js";import{w as de}from"../chunks/index.C85-89c0.js";const V=0,C=1,Y=2;function Re(a,e,r,o,c){q&&xe();var i=a,u=ke,h=X,l,_,f,s=Q(void 0),m=Q(void 0),p=!1;function d(v,w){p=!0,w&&($(z),ee(z),te(u));try{v===V&&r&&(l?B(l):l=P(()=>r(i))),v===C&&o&&(_?B(_):_=P(()=>o(i,s))),v===Y&&c&&(f?B(f):f=P(()=>c(i,m))),v!==V&&l&&R(l,()=>l=null),v!==C&&_&&R(_,()=>_=null),v!==Y&&f&&R(f,()=>f=null)}finally{w&&(te(null),ee(null),$(null),Pe())}}var z=ze(()=>{if(h!==(h=e())){if(Se(h)){var v=h;p=!1,v.then(w=>{v===h&&(U(s,w),d(C,!0))},w=>{if(v===h)throw U(m,w),d(Y,!0),m.v}),q?r&&(l=P(()=>r(i))):je(()=>{p||d(V,!0)})}else U(s,h),d(C,!1);return()=>h=X}});q&&(i=Ie)}function De(a,e,r){Ce(()=>{var o=Ee(()=>e(a,r==null?void 0:r())||{});if(r&&(o!=null&&o.update)){var c=!1,i={};Ne(()=>{var u=r();Ae(u),c&&He(i,u)&&(i=u,o.update(u))}),c=!0}if(o!=null&&o.destroy)return()=>o.destroy()})}function ve(a,e,r,o){var c=a.__styles??(a.__styles={});c[e]!==r&&(c[e]=r,r==null?a.style.removeProperty(e):a.style.setProperty(e,r,""))}var Me=G('<div class="scroller"></div>');function Ve(a,e){A(e,!0);let r=Ue(e,"value",15),o=b(()=>e.max);r()!==0&&Be(()=>{window.scrollTo(0,document.body.scrollHeight*(r()/n(o)))});function c(){const u=window.scrollY/(document.body.offsetHeight-window.innerHeight);r(u*n(o))}var i=Me();be("scroll",Oe,c),oe(()=>ve(i,"height",`${n(o)*100}vh`)),x(a,i),N()}function Ye(a,e){let r=ne(e),o,c,i=!0;function u({box:l}){o=new ResizeObserver(([_])=>{let f;l==="border-box"?f=_.borderBoxSize:l==="device-pixel-content-box"?f=_.devicePixelContentBoxSize:f=_.contentBoxSize,r.set(Array.isArray(f)?f[0]:f),i=!1}),o.observe(a,{box:l}),c=r.subscribe(_=>{i||a.dispatchEvent(new CustomEvent("has-resized",{detail:_}))})}function h(){o.disconnect(),c()}return u(ae(e)),{update(l){i=!0,r=ne(l),h(),u(ae(l))},destroy(){h()}}}function ne(a){if(typeof a=="object"){if(a.subscribe)return a;if(a.store)return a.store}return de({inlineSize:0,blockSize:0})}function ae(a){if(typeof a>"u"||a.subscribe)return{};const{store:e,...r}=a;return r}var Ge=G('<div class="item svelte-hrs2h8"><!></div>');function ie(a,e){A(e,!0);const r=ue(),o=()=>fe(i,"$size",r),c=16,i=de({inlineSize:0,blockSize:0});function u(s,m){const p=window.innerHeight,d=p/2;if(s>1)return-m;if(s<-1)return p;if(s>.5){const v=(s-.5)*2;return-m+d-d*v}if(s<-.5){const v=(s+1.5)*2-1;return p-d*v}const z=s+.5;return d-m*z}function h(s,m){if(m===0)return"";let p=1;if(s>.75&&s<1){const d=(s-.75)*4;p=1-d*d*.2}if(s<-.5&&s>-1){const d=(s+.5)*-2;p=1-d*d*.3}return`translateY(${u(s,m+c)}px) scale(${p})`}var l=Ge();const _=b(()=>h(e.scroll,o().blockSize));oe(()=>ve(l,"transform",n(_)));var f=ce(l);W(f,()=>e.children??L),le(l),De(l,(s,m)=>Ye(s,m),()=>i),x(a,l),N()}var Le=G('<!> <div class="viewport svelte-1hdbnwf"><!> <!></div>',1);function We(a,e){A(e,!0);const r=ue(),c=h(fe(qe,"$page",r).params.project),i=D({});let u=we(D(c));function h(t){return e.teasers.findIndex(g=>g.slug===t)}function l(t){const g=h(t);return i[g]||(i[g]=fetch(`/projects/${t}.json`).then(y=>y.json())),i[g]}function _(t){const{slug:g}=e.teasers[t],y=`/scrollytelling/${g}`;window.location.pathname!==y&&window.history.pushState({scroll:t},"",`/scrollytelling/${g}`)}function f(t){return{content:"",released:t.released,slug:t.slug,title:t.title}}let s=b(()=>Math.round(n(u))),m=b(()=>{var t;return(t=e.teasers[n(s)-1])==null?void 0:t.slug}),p=b(()=>{var t;return(t=e.teasers[n(s)])==null?void 0:t.slug}),d=b(()=>{var t;return(t=e.teasers[n(s)+1])==null?void 0:t.slug});k(()=>{n(m)&&l(n(m))}),k(()=>{n(p)&&l(n(p))}),k(()=>{n(d)&&l(n(d))});let z=b(()=>[n(s)-1,n(s),n(s)+1].filter(t=>t>=0&&t<e.teasers.length&&t!==c));k(()=>{_(n(s))});var v=Le(),w=S(v),he=b(()=>e.teasers.length-1);Ve(w,{get max(){return n(he)},get value(){return n(u)},set value(t){ye(u,D(t))}});var Z=re(w,2),F=ce(Z);Te(F,16,()=>n(z),t=>t,(t,g)=>{var y=b(()=>n(u)-g);ie(t,{get scroll(){return n(y)},children:(J,H)=>{var j=E(),me=S(j);Re(me,()=>i[g],O=>{var I=b(()=>f(e.teasers[g]));M(O,{get project(){return n(I)}})},(O,I)=>{var K=E(),ge=S(K);se(ge,()=>n(I),T=>{M(T,{get project(){return n(I)}})},T=>{var pe=b(()=>f(e.teasers[g]));M(T,{get project(){return n(pe)}})}),x(O,K)}),x(J,j)},$$slots:{default:!0}})});var _e=re(F,2);se(_e,()=>c>n(s)-2&&c<n(s)+2,t=>{var g=b(()=>n(u)-c);ie(t,{get scroll(){return n(g)},children:(y,J)=>{var H=E(),j=S(H);W(j,()=>e.children??L),x(y,H)},$$slots:{default:!0}})}),le(Z),x(a,v),N()}function st(a,e){A(e,!0),We(a,{get teasers(){return e.data.teasers},children:(r,o)=>{var c=E(),i=S(c);W(i,()=>e.children??L),x(r,c)},$$slots:{default:!0}}),N()}export{st as component};
