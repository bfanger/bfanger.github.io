import{e as ze,a as x,t as G,g as E}from"../chunks/disclose-version.JykmFiKV.js";import{h as T,j as Se,b as je,aH as Ie,z as q,v as B,x as Pe,a0 as Q,q as ke,O as W,aj as $,ai as ee,aI as te,u as re,w as R,a8 as Ce,X as Ee,U as He,S as Ne,V as Ae,aJ as Oe,R as Te,t as ce,p as H,a as N,a2 as qe,g as s,d as b,c as le,n as J,r as ue,_ as Be,Y as k,f as j,Z as Re,s as se}from"../chunks/runtime.CrXZZmSf.js";import{s as L}from"../chunks/snippet.DuGttwlc.js";import{i as ne}from"../chunks/7.BmDtEfvE.js";import{e as Ue}from"../chunks/each.DwjJ4X4p.js";import{p as Ye,s as fe,a as de,d as U}from"../chunks/props.jwxUQCd7.js";import{p as De}from"../chunks/stores.D_M7A_TR.js";import{P as Y}from"../chunks/ProjectCard.BLqM_X-q.js";import{o as Me}from"../chunks/index-client.CwQpoN-l.js";import{w as ve}from"../chunks/index.j47-sshA.js";const D=0,C=1,M=2;function Ze(n,e,a,i,l){T&&Se();var o=n,u=Ee,v=Q,c,_,h,r=W(void 0),g=W(void 0),p=!1;function f(d,w){p=!0,w&&($(z),ee(z),te(u));try{d===D&&a&&(c?re(c):c=B(()=>a(o))),d===C&&i&&(_?re(_):_=B(()=>i(o,r))),d!==D&&c&&R(c,()=>c=null),d!==C&&_&&R(_,()=>_=null),d!==M&&h&&R(h,()=>h=null)}finally{w&&(te(null),ee(null),$(null),Ce())}}var z=je(()=>{if(v!==(v=e())){if(Ie(v)){var d=v;p=!1,d.then(w=>{d===v&&(q(r,w),f(C,!0))},w=>{if(d===v)throw q(g,w),f(M,!0),g.v}),T?c=B(()=>a(o)):Pe(()=>{p||f(D,!0)})}else q(r,v),f(C,!1);return()=>v=Q}});T&&(o=ke)}function Ge(n,e,a){He(()=>{var i=Ne(()=>e(n,a==null?void 0:a())||{});if(i!=null&&i.update){var l=!1,o={};Ae(()=>{var u=a();Oe(u),l&&Te(o,u)&&(o=u,i.update(u))}),l=!0}if(i!=null&&i.destroy)return()=>i.destroy()})}function _e(n,e,a,i){var l=n.__styles??(n.__styles={});l[e]!==a&&(l[e]=a,a==null?n.style.removeProperty(e):n.style.setProperty(e,a,""))}var Je=G('<div class="scroller"></div>');function Le(n,e){N(e,!0);let a=Ye(e,"value",15),i=b(()=>e.max);a()!==0&&Me(()=>{window.scrollTo(0,document.body.scrollHeight*(a()/s(i)))});function l(){const u=window.scrollY/(document.body.offsetHeight-window.innerHeight);a(u*s(i))}var o=Je();ze("scroll",qe,l),ce(()=>_e(o,"height",`${s(i)*100}vh`)),x(n,o),H()}function Z(n,e){let a=ae(e),i,l,o=!0;function u({box:c}){i=new ResizeObserver(([_])=>{let h;c==="border-box"?h=_.borderBoxSize:c==="device-pixel-content-box"?h=_.devicePixelContentBoxSize:h=_.contentBoxSize,a.set(Array.isArray(h)?h[0]:h),o=!1}),i.observe(n,{box:c}),l=a.subscribe(_=>{o||n.dispatchEvent(new CustomEvent("has-resized",{detail:_}))})}function v(){i.disconnect(),l()}return u(ie(e)),{update(c){o=!0,a=ae(c),v(),u(ie(c))},destroy(){v()}}}function ae(n){if(typeof n=="object"){if(n.subscribe)return n;if(n.store)return n.store}return ve({inlineSize:0,blockSize:0})}function ie(n){if(typeof n>"u"||n.subscribe)return{};const{store:e,...a}=n;return a}var Ve=G('<div class="item svelte-hrs2h8"><!></div>');function oe(n,e){N(e,!0);const a=fe(),i=()=>de(o,"$size",a),l=16,o=ve({inlineSize:0,blockSize:0});function u(r,g){const p=window.innerHeight,f=p/2;if(r>1)return-g;if(r<-1)return p;if(r>.5){const d=(r-.5)*2;return-g+f-f*d}if(r<-.5){const d=(r+1.5)*2-1;return p-f*d}const z=r+.5;return f-g*z}function v(r,g){if(g===0)return"";let p=1;if(r>.75&&r<1){const f=(r-.75)*4;p=1-f*f*.2}if(r<-.5&&r>-1){const f=(r+.5)*-2;p=1-f*f*.3}return`translateY(${u(r,g+l)}px) scale(${p})`}var c=Ve();const _=b(()=>v(e.scroll,i().blockSize));ce(()=>_e(c,"transform",s(_)));var h=le(c);L(h,()=>e.children??J),ue(c),Ge(c,(r,g)=>Z==null?void 0:Z(r,g),()=>o),x(n,c),H()}var Xe=G('<!> <div class="viewport svelte-1hdbnwf"><!> <!></div>',1);function Fe(n,e){N(e,!0);const a=fe(),l=v(de(De,"$page",a).params.project),o=U({});let u=Be(U(l));function v(t){return e.teasers.findIndex(m=>m.slug===t)}function c(t){const m=v(t);return o[m]||(o[m]=fetch(`/projects/${t}.json`).then(y=>y.json())),o[m]}function _(t){const{slug:m}=e.teasers[t],y=`/scrollytelling/${m}`;window.location.pathname!==y&&window.history.pushState({scroll:t},"",`/scrollytelling/${m}`)}function h(t){return{content:"",released:t.released,slug:t.slug,title:t.title}}let r=b(()=>Math.round(s(u))),g=b(()=>{var t;return(t=e.teasers[s(r)-1])==null?void 0:t.slug}),p=b(()=>{var t;return(t=e.teasers[s(r)])==null?void 0:t.slug}),f=b(()=>{var t;return(t=e.teasers[s(r)+1])==null?void 0:t.slug});k(()=>{s(g)&&c(s(g))}),k(()=>{s(p)&&c(s(p))}),k(()=>{s(f)&&c(s(f))});let z=b(()=>[s(r)-1,s(r),s(r)+1].filter(t=>t>=0&&t<e.teasers.length&&t!==l));k(()=>{_(s(r))});var d=Xe(),w=j(d),he=b(()=>e.teasers.length-1);Le(w,{get max(){return s(he)},get value(){return s(u)},set value(t){Re(u,U(t))}});var V=se(w,2),X=le(V);Ue(X,16,()=>s(z),t=>t,(t,m)=>{var y=b(()=>s(u)-m);oe(t,{get scroll(){return s(y)},children:(F,A)=>{var I=E(),pe=j(I);Ze(pe,()=>o[m],O=>{var P=b(()=>h(e.teasers[m]));Y(O,{get project(){return s(P)}})},(O,P)=>{var K=E(),be=j(K);{var we=S=>{Y(S,{get project(){return s(P)}})},ye=S=>{var xe=b(()=>h(e.teasers[m]));Y(S,{get project(){return s(xe)}})};ne(be,S=>{s(P)?S(we):S(ye,!1)})}x(O,K)}),x(F,I)},$$slots:{default:!0}})});var me=se(X,2);{var ge=t=>{var m=b(()=>s(u)-l);oe(t,{get scroll(){return s(m)},children:(y,F)=>{var A=E(),I=j(A);L(I,()=>e.children??J),x(y,A)},$$slots:{default:!0}})};ne(me,t=>{l>s(r)-2&&l<s(r)+2&&t(ge)})}ue(V),x(n,d),H()}function it(n,e){N(e,!0),Fe(n,{get teasers(){return e.data.teasers},children:(a,i)=>{var l=E(),o=j(l);L(o,()=>e.children??J),x(a,l)},$$slots:{default:!0}}),H()}export{it as component};
