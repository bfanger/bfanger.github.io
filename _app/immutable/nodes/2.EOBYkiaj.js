import{i as ie,f as ue,h as E,j as ae,s as M,c as H,k as fe,u as N,g as R,d as Y,e as le,n as w,o as _e,b as de,l as me}from"../chunks/scheduler.6qIGuNQq.js";import{p as q,t as b,b as P,d as g,S as O,i as V,g as L,h as T,j as U,f as k,k as F,l as B,a as y,x as pe,y as he,r as j,s as J,u as S,c as K,v as z,z as ge,w as I,e as C}from"../chunks/index.SKX3nl_2.js";import{e as Q,u as be,o as $e}from"../chunks/each.5Ky8mcUv.js";import{w as ne}from"../chunks/index.j58Y86NW.js";import{p as ke}from"../chunks/stores.slRvomE_.js";import{g as we}from"../chunks/globals.0cDDIVm6.js";import{P as G}from"../chunks/ProjectCard.3kWSprbL.js";function W(r,e){const s=e.token={};function t(l,n,o,i){if(e.token!==s)return;e.resolved=i;let c=e.ctx;o!==void 0&&(c=c.slice(),c[o]=i);const _=l&&(e.current=l)(c);let m=!1;e.block&&(e.blocks?e.blocks.forEach((h,$)=>{$!==n&&h&&(q(),b(h,1,1,()=>{e.blocks[$]===h&&(e.blocks[$]=null)}),P())}):e.block.d(1),_.c(),g(_,1),_.m(e.mount(),e.anchor),m=!0),e.block=_,e.blocks&&(e.blocks[n]=_),m&&ae()}if(ie(r)){const l=ue();if(r.then(n=>{E(l),t(e.then,1,e.value,n),E(null)},n=>{if(E(l),t(e.catch,2,e.error,n),E(null),!e.hasCatch)throw n}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,r),!0;e.resolved=r}}function ve(r,e,s){const t=e.slice(),{resolved:l}=r;r.current===r.then&&(t[r.value]=l),r.current===r.catch&&(t[r.error]=l),r.block.p(t,s)}function ye(r,e){let s=X(e),t,l,n=!0;function o({box:c}){t=new ResizeObserver(([_])=>{let m;c==="border-box"?m=_.borderBoxSize:c==="device-pixel-content-box"?m=_.devicePixelContentBoxSize:m=_.contentBoxSize,s.set(Array.isArray(m)?m[0]:m),n=!1}),t.observe(r,{box:c}),l=s.subscribe(_=>{n||r.dispatchEvent(new CustomEvent("has-resized",{detail:_}))})}function i(){t.disconnect(),l()}return o(Z(e)),{update(c){n=!0,s=X(c),i(),o(Z(c))},destroy(){i()}}}function X(r){if(typeof r=="object"){if(r.subscribe)return r;if(r.store)return r.store}return ne({inlineSize:0,blockSize:0})}function Z(r){if(typeof r>"u"||r.subscribe)return{};const{store:e,...s}=r;return s}function je(r){let e,s,t,l;const n=r[4].default,o=H(n,r,r[3],null);return{c(){e=L("div"),o&&o.c(),this.h()},l(i){e=T(i,"DIV",{class:!0});var c=U(e);o&&o.l(c),c.forEach(k),this.h()},h(){F(e,"class","item svelte-qqcwqq"),B(e,"transform",x(r[0],r[1].blockSize))},m(i,c){y(i,e,c),o&&o.m(e,null),s=!0,t||(l=fe(ye.call(null,e,r[2])),t=!0)},p(i,[c]){o&&o.p&&(!s||c&8)&&N(o,n,i,i[3],s?Y(n,i[3],c,null):R(i[3]),null),c&3&&B(e,"transform",x(i[0],i[1].blockSize))},i(i){s||(g(o,i),s=!0)},o(i){b(o,i),s=!1},d(i){i&&k(e),o&&o.d(i),t=!1,l()}}}const Se=16;function ze(r,e){const s=window.innerHeight,t=s/2;if(r>1)return-e;if(r<-1)return s;if(r>.5){const n=(r-.5)*2;return-e+t-t*n}if(r<-.5){const n=(r+1.5)*2-1;return s-t*n}const l=r+.5;return t-e*l}function x(r,e){if(e===0)return"";let s=1;if(r>.75&&r<1){const t=(r-.75)*4;s=1-t*t*.2}if(r<-.5&&r>-1){const t=(r+.5)*-2;s=1-t*t*.3}return`translateY(${ze(r,e+Se)}px) scale(${s})`}function Ie(r,e,s){let t,{$$slots:l={},$$scope:n}=e,{scroll:o}=e;const i=ne({inlineSize:0,blockSize:0});return le(r,i,c=>s(1,t=c)),r.$$set=c=>{"scroll"in c&&s(0,o=c.scroll),"$$scope"in c&&s(3,n=c.$$scope)},[o,t,i,n,l]}class se extends O{constructor(e){super(),V(this,e,Ie,je,M,{scroll:0})}}const{window:Ce}=we;function Ee(r){let e,s=`${r[0]*100}vh`,t,l;return{c(){e=L("div"),this.h()},l(n){e=T(n,"DIV",{class:!0}),U(e).forEach(k),this.h()},h(){F(e,"class","scroller"),B(e,"height",s)},m(n,o){y(n,e,o),t||(l=pe(Ce,"scroll",r[1]),t=!0)},p(n,[o]){o&1&&s!==(s=`${n[0]*100}vh`)&&B(e,"height",s)},i:w,o:w,d(n){n&&k(e),t=!1,l()}}}function qe(r,e,s){let t,{max:l}=e,{value:n}=e;n!==0&&_e(()=>{window.scrollTo(0,document.body.scrollHeight*(n/t))});function o(){const i=window.scrollY/(document.body.offsetHeight-window.innerHeight);s(2,n=i*t)}return r.$$set=i=>{"max"in i&&s(3,l=i.max),"value"in i&&s(2,n=i.value)},r.$$.update=()=>{r.$$.dirty&8&&s(0,t=l)},[t,o,n,l]}class Pe extends O{constructor(e){super(),V(this,e,qe,Ee,M,{max:3,value:2})}}function ee(r,e,s){const t=r.slice();return t[16]=e[s],t}function Be(r){return{c:w,l:w,m:w,p:w,i:w,o:w,d:w}}function De(r){let e,s,t,l;const n=[Oe,Me],o=[];function i(c,_){return c[19]?0:1}return e=i(r),s=o[e]=n[e](r),{c(){s.c(),t=C()},l(c){s.l(c),t=C()},m(c,_){o[e].m(c,_),y(c,t,_),l=!0},p(c,_){let m=e;e=i(c),e===m?o[e].p(c,_):(q(),b(o[m],1,1,()=>{o[m]=null}),P(),s=o[e],s?s.p(c,_):(s=o[e]=n[e](c),s.c()),g(s,1),s.m(t.parentNode,t))},i(c){l||(g(s),l=!0)},o(c){b(s),l=!1},d(c){c&&k(t),o[e].d(c)}}}function Me(r){let e,s;return e=new G({props:{project:D(r[0][r[16]])}}),{c(){j(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,l){z(e,t,l),s=!0},p(t,l){const n={};l&17&&(n.project=D(t[0][t[16]])),e.$set(n)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){b(e.$$.fragment,t),s=!1},d(t){I(e,t)}}}function Oe(r){let e,s;return e=new G({props:{project:r[19]}}),{c(){j(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,l){z(e,t,l),s=!0},p(t,l){const n={};l&24&&(n.project=t[19]),e.$set(n)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){b(e.$$.fragment,t),s=!1},d(t){I(e,t)}}}function Ve(r){let e,s;return e=new G({props:{project:D(r[0][r[16]])}}),{c(){j(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,l){z(e,t,l),s=!0},p(t,l){const n={};l&17&&(n.project=D(t[0][t[16]])),e.$set(n)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){b(e.$$.fragment,t),s=!1},d(t){I(e,t)}}}function Ae(r){let e,s,t,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Ve,then:De,catch:Be,value:19,blocks:[,,,]};return W(s=r[3][r[16]],l),{c(){e=C(),l.block.c()},l(n){e=C(),l.block.l(n)},m(n,o){y(n,e,o),l.block.m(n,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e,t=!0},p(n,o){r=n,l.ctx=r,o&24&&s!==(s=r[3][r[16]])&&W(s,l)||ve(l,r,o)},i(n){t||(g(l.block),t=!0)},o(n){for(let o=0;o<3;o+=1){const i=l.blocks[o];b(i)}t=!1},d(n){n&&k(e),l.block.d(n),l.token=null,l=null}}}function te(r,e){let s,t,l;return t=new se({props:{scroll:e[1]-e[16],$$slots:{default:[Ae]},$$scope:{ctx:e}}}),{key:r,first:null,c(){s=C(),j(t.$$.fragment),this.h()},l(n){s=C(),S(t.$$.fragment,n),this.h()},h(){this.first=s},m(n,o){y(n,s,o),z(t,n,o),l=!0},p(n,o){e=n;const i={};o&18&&(i.scroll=e[1]-e[16]),o&2073&&(i.$$scope={dirty:o,ctx:e}),t.$set(i)},i(n){l||(g(t.$$.fragment,n),l=!0)},o(n){b(t.$$.fragment,n),l=!1},d(n){n&&k(s),I(t,n)}}}function re(r){let e,s;return e=new se({props:{scroll:r[1]-r[5],$$slots:{default:[He]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,l){z(e,t,l),s=!0},p(t,l){const n={};l&2&&(n.scroll=t[1]-t[5]),l&2048&&(n.$$scope={dirty:l,ctx:t}),e.$set(n)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){b(e.$$.fragment,t),s=!1},d(t){I(e,t)}}}function He(r){let e;const s=r[9].default,t=H(s,r,r[11],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,n){t&&t.m(l,n),e=!0},p(l,n){t&&t.p&&(!e||n&2048)&&N(t,s,l,l[11],e?Y(s,l[11],n,null):R(l[11]),null)},i(l){e||(g(t,l),e=!0)},o(l){b(t,l),e=!1},d(l){t&&t.d(l)}}}function Ne(r){let e,s,t,l,n=[],o=new Map,i,c;function _(u){r[10](u)}let m={max:r[0].length-1};r[1]!==void 0&&(m.value=r[1]),e=new Pe({props:m}),de.push(()=>he(e,"value",_));let h=Q(r[4]);const $=u=>u[16];for(let u=0;u<h.length;u+=1){let a=ee(r,h,u),p=$(a);o.set(p,n[u]=te(p,a))}let f=r[5]>r[2]-2&&r[5]<r[2]+2&&re(r);return{c(){j(e.$$.fragment),t=J(),l=L("div");for(let u=0;u<n.length;u+=1)n[u].c();i=J(),f&&f.c(),this.h()},l(u){S(e.$$.fragment,u),t=K(u),l=T(u,"DIV",{class:!0});var a=U(l);for(let p=0;p<n.length;p+=1)n[p].l(a);i=K(a),f&&f.l(a),a.forEach(k),this.h()},h(){F(l,"class","viewport svelte-d5sas8")},m(u,a){z(e,u,a),y(u,t,a),y(u,l,a);for(let p=0;p<n.length;p+=1)n[p]&&n[p].m(l,null);ge(l,i),f&&f.m(l,null),c=!0},p(u,[a]){const p={};a&1&&(p.max=u[0].length-1),!s&&a&2&&(s=!0,p.value=u[1],me(()=>s=!1)),e.$set(p),a&27&&(h=Q(u[4]),q(),n=be(n,a,$,1,u,h,o,l,$e,te,i,ee),P()),u[5]>u[2]-2&&u[5]<u[2]+2?f?(f.p(u,a),a&4&&g(f,1)):(f=re(u),f.c(),g(f,1),f.m(l,null)):f&&(q(),b(f,1,1,()=>{f=null}),P())},i(u){if(!c){g(e.$$.fragment,u);for(let a=0;a<h.length;a+=1)g(n[a]);g(f),c=!0}},o(u){b(e.$$.fragment,u);for(let a=0;a<n.length;a+=1)b(n[a]);b(f),c=!1},d(u){u&&(k(t),k(l)),I(e,u);for(let a=0;a<n.length;a+=1)n[a].d();f&&f.d()}}}function D(r){return{content:"",released:r.released,slug:r.slug,title:r.title}}function Re(r,e,s){let t,l,n,o,i,c;le(r,ke,d=>s(12,c=d));let{$$slots:_={},$$scope:m}=e,{teasers:h}=e;const $=a(c.params.project),f={};let u=$;function a(d){return h.findIndex(v=>v.slug===d)}function p(d){const v=a(d);return f[v]||s(3,f[v]=fetch(`/projects/${d}.json`).then(A=>A.json()),f),f[v]}function oe(d){const{slug:v}=h[d],A=`/scrollytelling/${v}`;window.location.pathname!==A&&window.history.pushState({scroll:d},"",`/scrollytelling/${v}`)}function ce(d){u=d,s(1,u)}return r.$$set=d=>{"teasers"in d&&s(0,h=d.teasers),"$$scope"in d&&s(11,m=d.$$scope)},r.$$.update=()=>{r.$$.dirty&2&&s(2,t=Math.round(u)),r.$$.dirty&5&&s(8,l=h[t-1]?.slug),r.$$.dirty&5&&s(7,n=h[t]?.slug),r.$$.dirty&5&&s(6,o=h[t+1]?.slug),r.$$.dirty&256&&l&&p(l),r.$$.dirty&128&&n&&p(n),r.$$.dirty&64&&o&&p(o),r.$$.dirty&5&&s(4,i=[t-1,t,t+1].filter(d=>d>=0&&d<h.length&&d!==$)),r.$$.dirty&4&&oe(t)},[h,u,t,f,i,$,o,n,l,_,ce,m]}class Ye extends O{constructor(e){super(),V(this,e,Re,Ne,M,{teasers:0})}}function Le(r){let e;const s=r[1].default,t=H(s,r,r[2],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,n){t&&t.m(l,n),e=!0},p(l,n){t&&t.p&&(!e||n&4)&&N(t,s,l,l[2],e?Y(s,l[2],n,null):R(l[2]),null)},i(l){e||(g(t,l),e=!0)},o(l){b(t,l),e=!1},d(l){t&&t.d(l)}}}function Te(r){let e,s;return e=new Ye({props:{teasers:r[0].teasers,$$slots:{default:[Le]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,l){z(e,t,l),s=!0},p(t,[l]){const n={};l&1&&(n.teasers=t[0].teasers),l&4&&(n.$$scope={dirty:l,ctx:t}),e.$set(n)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){b(e.$$.fragment,t),s=!1},d(t){I(e,t)}}}function Ue(r,e,s){let{$$slots:t={},$$scope:l}=e,{data:n}=e;return r.$$set=o=>{"data"in o&&s(0,n=o.data),"$$scope"in o&&s(2,l=o.$$scope)},[n,t,l]}class Ze extends O{constructor(e){super(),V(this,e,Ue,Te,M,{data:0})}}export{Ze as component};
