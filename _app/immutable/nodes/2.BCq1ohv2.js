import{B as ve,f as L,a as w,t as me,c as B}from"../chunks/DStJdtfk.js";import{h as P,d as ge,b as he,b0 as Z,H as _e,k as pe,j as be,l as $,R as ye,S as D,z as F,b1 as we,aD as Se,b2 as ze,b3 as xe,ag as je,ad as ke,W as Ie,Y as Pe,X as Ne,b4 as Be,a2 as Ee,p as E,t as re,a as T,g as t,u as p,a$ as Te,c as M,n as U,r as q,ak as J,a3 as Ae,a0 as N,f as j,s as O,a4 as He,al as Re}from"../chunks/ThGk_jmN.js";import{s as G}from"../chunks/BNDkNWVb.js";import{p as $e,e as De,f as Oe,g as Ye,d as Ce}from"../chunks/hsJnoF2d.js";import{i as K}from"../chunks/DkrOlUq1.js";import{e as Me}from"../chunks/ja_2KDSf.js";import{p as qe}from"../chunks/CDkRZfgB.js";import{P as Y}from"../chunks/CUWiJT7B.js";import{o as Le}from"../chunks/vf3ojiBI.js";import{s as se}from"../chunks/B6A99GZm.js";import{w as ae}from"../chunks/DwqM-yb3.js";import{c as Ue,N as Ge}from"../chunks/Dyh2g_Q6.js";const Q=0,C=1;function We(n,e,s,o,l){P&&ge();var u=ke,c=F(u),_=F(u),v=new ve(n);he(()=>{var a=e(),g=!1;let S=P&&Z(a)===(n.data===_e);if(S&&(pe(be()),$(!1)),Z(a)){var i=we(),h=!1;const m=d=>{if(!g){h=!0,i(!1),Se.ensure(),P&&$(!1);try{d()}finally{ze(),xe||je()}}};a.then(d=>{m(()=>{D(c,d),v.ensure(C,o&&(b=>o(b,c)))})},d=>{m(()=>{if(D(_,d),v.ensure(C,l&&(b=>l(b,_))),!l)throw _.v})}),P?v.ensure(Q,s):ye(()=>{h||m(()=>{v.ensure(Q,s)})})}else D(c,a),v.ensure(C,o&&(m=>o(m,c)));return S&&$(!0),()=>{g=!0}})}function Xe(n,e,s){Ie(()=>{var o=Pe(()=>e(n,s?.())||{});if(s&&o?.update){var l=!1,u={};Ne(()=>{var c=s();Be(c),l&&Ee(u,c)&&(u=c,o.update(c))}),l=!0}if(o?.destroy)return()=>o.destroy()})}var Ze=L('<div class="scroller"></div>');function Fe(n,e){E(e,!0);let s=$e(e,"value",15),o=p(()=>e.max);s()!==0&&Le(()=>{window.scrollTo(0,document.body.scrollHeight*(s()/t(o)))});function l(){const _=window.scrollY/(document.body.offsetHeight-window.innerHeight);s(_*t(o))}var u=Ze();De("scroll",Te,l);let c;re(()=>c=se(u,"",c,{height:`${t(o)*100}vh`})),w(n,u),T()}function Je(n,e){let s=V(e),o,l,u=!0;function c({box:v}){o=new ResizeObserver(([a])=>{let g;v==="border-box"?g=a.borderBoxSize:v==="device-pixel-content-box"?g=a.devicePixelContentBoxSize:g=a.contentBoxSize,s.set(Array.isArray(g)?g[0]:g),u=!1}),o.observe(n,{box:v}),l=s.subscribe(a=>{u||n.dispatchEvent(new CustomEvent("has-resized",{detail:a}))})}function _(){o.disconnect(),l()}return c(ee(e)),{update(v){u=!0,s=V(v),_(),c(ee(v))},destroy(){_()}}}function V(n){if(typeof n=="object"){if(n.subscribe)return n;if(n.store)return n.store}return ae({inlineSize:0,blockSize:0})}function ee(n){if(typeof n>"u"||n.subscribe)return{};const{store:e,...s}=n;return s}var Ke=L('<div class="item svelte-1g87s5s"><!></div>');function te(n,e){E(e,!0);const s=()=>Oe(c,"$size",o),[o,l]=Ye(),u=16,c=ae({inlineSize:0,blockSize:0});function _(i,h){const m=window.innerHeight,d=m/2;if(i>1)return-h;if(i<-1)return m;if(i>.5){const z=(i-.5)*2;return-h+d-d*z}if(i<-.5){const z=(i+1.5)*2-1;return m-d*z}const b=i+.5;return d-h*b}function v(i,h){if(h===0)return"";let m=1;if(i>.75&&i<1){const d=(i-.75)*4;m=1-d*d*.2}if(i<-.5&&i>-1){const d=(i+.5)*-2;m=1-d*d*.3}return`translateY(${_(i,h+u)}px) scale(${m})`}var a=Ke();let g;var S=M(a);G(S,()=>e.children??U),q(a),Xe(a,(i,h)=>Je?.(i,h),()=>c),re(i=>g=se(a,"",g,i),[()=>({transform:v(e.scroll,s().blockSize)})]),w(n,a),T(),l()}var Qe=L('<!> <div class="viewport svelte-105t3g3"><!> <!></div> <div class="previous svelte-105t3g3"><!></div>',1);function Ve(n,e){E(e,!0);const s=u(qe.params.project??""),o=J({});let l=Ae(J(s));function u(r){return e.teasers.findIndex(f=>f.slug===r)}function c(r){const f=u(r);return o[f]||(o[f]=fetch(`/projects/${r}.json`).then(y=>y.json())),o[f]}function _(r){const{slug:f}=e.teasers[r],y=`/projects/${f}`;window.location.pathname!==y&&window.history.replaceState({scroll:r},"",`/projects/${f}`)}function v(r){return{content:"",released:r.released,slug:r.slug,title:r.title}}let a=p(()=>Math.round(t(l))),g=p(()=>e.teasers[t(a)-1]?.slug),S=p(()=>e.teasers[t(a)]?.slug),i=p(()=>e.teasers[t(a)+1]?.slug);N(()=>{t(g)&&c(t(g))}),N(()=>{t(S)&&c(t(S))}),N(()=>{t(i)&&c(t(i))});let h=p(()=>[t(a)-1,t(a),t(a)+1].filter(r=>r>=0&&r<e.teasers.length&&r!==s));N(()=>{_(t(a))});var m=Qe(),d=j(m);{let r=p(()=>e.teasers.length-1);Fe(d,{get max(){return t(r)},get value(){return t(l)},set value(f){He(l,f,!0)}})}var b=O(d,2),z=M(b);Me(z,16,()=>t(h),r=>r,(r,f)=>{{let y=p(()=>t(l)-f);te(r,{get scroll(){return t(y)},children:(W,H)=>{var k=B(),le=j(k);We(le,()=>o[f],R=>{{let I=p(()=>v(e.teasers[f]));Y(R,{get project(){return t(I)}})}},(R,I)=>{var X=B(),ce=j(X);{var ue=x=>{Y(x,{get project(){return t(I)}})},de=x=>{{let fe=p(()=>v(e.teasers[f]));Y(x,{get project(){return t(fe)}})}};K(ce,x=>{t(I)?x(ue):x(de,!1)})}w(R,X)}),w(W,k)},$$slots:{default:!0}})}});var ne=O(z,2);{var oe=r=>{{let f=p(()=>t(l)-s);te(r,{get scroll(){return t(f)},children:(y,W)=>{var H=B(),k=j(H);G(k,()=>e.children??U),w(y,H)},$$slots:{default:!0}})}};K(ne,r=>{s>t(a)-2&&s<t(a)+2&&r(oe)})}q(b);var A=O(b,2);A.__mousedown=()=>{Ue.set("right")};var ie=M(A);Ge(ie,{href:"/portfolio",type:"previous",children:(r,f)=>{Re();var y=me("Portfolio");w(r,y)},$$slots:{default:!0}}),q(A),w(n,m),T()}Ce(["mousedown"]);function ft(n,e){E(e,!0),Ve(n,{get teasers(){return e.data.teasers},children:(s,o)=>{var l=B(),u=j(l);G(u,()=>e.children??U),w(s,l)},$$slots:{default:!0}}),T()}export{ft as component};
