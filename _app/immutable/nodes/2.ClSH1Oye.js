import{B as ze,f as L,a as x,t as xe,c as q}from"../chunks/CAg0ZyGv.js";import{h as A,d as ye,b as Se,b0 as X,H as je,k as ke,j as Ie,l as R,R as Ae,S as C,z as $,b1 as Pe,aC as qe,b2 as Ne,b3 as Be,al as De,ai as Ee,a2 as ne,Z as ie,aA as Oe,b4 as Te,_ as Re,p as B,f as j,t as oe,a as D,g as a,a8 as le,a$ as J,s as N,a9 as ce,c as H,n as ue,r as Y,ap as K,X as P,u as w,aq as Ce}from"../chunks/DrfILjJG.js";import{s as U}from"../chunks/B5mdmElG.js";import{p as Me,f as Q,g as Fe,j as He,d as Ye}from"../chunks/Cs29mKmA.js";import{i as V}from"../chunks/BTif1B6A.js";import{e as Le}from"../chunks/BklWPKWu.js";import{t as ee}from"../chunks/Cshrk9Xc.js";import{p as Ue}from"../chunks/Bi-nBRkk.js";import{P as M}from"../chunks/DXKBE5B7.js";import{o as We}from"../chunks/BjTyozP6.js";import{a as de}from"../chunks/CTPX2zIG.js";import{w as fe}from"../chunks/BgNYpTDD.js";import{c as Ze,N as Ge,a as Xe,b as $e}from"../chunks/B0GOCI7v.js";const te=0,F=1;function Je(s,e,t,r,i){A&&ye();var f=Ee,u=$(f),v=$(f),d=new ze(s);Se(()=>{var n=e(),g=!1;let p=A&&X(n)===(s.data===je);if(p&&(ke(Ie()),R(!1)),X(n)){var o=Pe(),b=!1;const m=c=>{if(!g){b=!0,o(!1),qe.ensure(),A&&R(!1);try{c()}finally{Ne(),Be||De()}}};n.then(c=>{m(()=>{C(u,c),d.ensure(F,r&&(_=>r(_,u)))})},c=>{m(()=>{if(C(v,c),d.ensure(F,i&&(_=>i(_,v))),!i)throw v.v})}),A?d.ensure(te,t):Ae(()=>{b||m(()=>{d.ensure(te,t)})})}else C(u,n),d.ensure(F,r&&(m=>r(m,u)));return p&&R(!0),()=>{g=!0}})}function Ke(s,e,t){ne(()=>{var r=ie(()=>e(s,t?.())||{});if(t&&r?.update){var i=!1,f={};Oe(()=>{var u=t();Te(u),i&&Re(f,u)&&(f=u,r.update(u))}),i=!0}if(r?.destroy)return()=>r.destroy()})}class W{#e=new WeakMap;#t;#r;static entries=new WeakMap;constructor(e){this.#r=e}observe(e,t){var r=this.#e.get(e)||new Set;return r.add(t),this.#e.set(e,r),this.#s().observe(e,this.#r),()=>{var i=this.#e.get(e);i.delete(t),i.size===0&&(this.#e.delete(e),this.#t.unobserve(e))}}#s(){return this.#t??(this.#t=new ResizeObserver(e=>{for(var t of e){W.entries.set(t.target,t);for(var r of this.#e.get(t.target)||[])r(t)}}))}}var Qe=new W({box:"border-box"});function Ve(s,e,t){var r=Qe.observe(s,()=>t(s[e]));ne(()=>(ie(()=>t(s[e])),r))}var et=L('<div class="scroller svelte-142q3nm"></div> <div class="size svelte-142q3nm"></div>',1);function tt(s,e){B(e,!0);let t=Me(e,"value",15),r=le(0);t()!==0&&We(()=>{window.scrollTo(0,a(r)*t())});function i(){const c=window.scrollY/(a(r)*e.max);t(c*e.max)}let f=Date.now(),u=t(),v;function d(){i(),u!==t()?(f=Date.now(),u=t(),v=requestAnimationFrame(d)):Date.now()-f<1e3?v=requestAnimationFrame(d):v=void 0}function n(){f=Date.now(),i(),v||(v=requestAnimationFrame(d))}function g(){i(),v&&(cancelAnimationFrame(v),v=void 0)}var p=et();Q("scroll",J,n),Q("scrollend",J,g);var o=j(p);let b;var m=N(o,2);oe(()=>b=de(o,"",b,{height:`${e.max*100}svh`})),Ve(m,"clientHeight",c=>ce(r,c)),x(s,p),D()}function rt(s,e){let t=re(e),r,i,f=!0;function u({box:d}){r=new ResizeObserver(([n])=>{let g;d==="border-box"?g=n.borderBoxSize:d==="device-pixel-content-box"?g=n.devicePixelContentBoxSize:g=n.contentBoxSize,t.set(Array.isArray(g)?g[0]:g),f=!1}),r.observe(s,{box:d}),i=t.subscribe(n=>{f||s.dispatchEvent(new CustomEvent("has-resized",{detail:n}))})}function v(){r.disconnect(),i()}return u(se(e)),{update(d){f=!0,t=re(d),v(),u(se(d))},destroy(){v()}}}function re(s){if(typeof s=="object"){if(s.subscribe)return s;if(s.store)return s.store}return fe({inlineSize:0,blockSize:0})}function se(s){if(typeof s>"u"||s.subscribe)return{};const{store:e,...t}=s;return t}var st=L('<div class="item svelte-1g87s5s"><!></div>');function ae(s,e){B(e,!0);const t=()=>Fe(u,"$size",r),[r,i]=He(),f=16,u=fe({inlineSize:0,blockSize:0});function v(o,b){const m=window.innerHeight,c=m/2;if(o>1)return-b;if(o<-1)return m;if(o>.5){const y=(o-.5)*2;return-b+c-c*y}if(o<-.5){const y=(o+1.5)*2-1;return m-c*y}const _=o+.5;return c-b*_}function d(o,b){if(b===0)return"";let m=1;if(o>.75&&o<1){const c=(o-.75)*4;m=1-c*c*.2}if(o<-.5&&o>-1){const c=(o+.5)*-2;m=1-c*c*.3}return`translateY(${v(o,b+f)}px) scale(${m})`}var n=st();let g;var p=H(n);U(p,()=>e.children??ue),Y(n),Ke(n,(o,b)=>rt?.(o,b),()=>u),oe(o=>g=de(n,"",g,o),[()=>({transform:d(e.scroll,t().blockSize)})]),x(s,n),D(),i()}var at=L('<!> <div class="viewport svelte-105t3g3"><!> <!></div> <div class="previous svelte-105t3g3"><!></div>',1);function nt(s,e){B(e,!0);const t=f(Ue.params.project??""),r=K({});let i=le(K(t));function f(l){return e.teasers.findIndex(h=>h.slug===l)}function u(l){const h=f(l);return r[h]||(r[h]=fetch(`/projects/${l}.json`).then(z=>z.json())),r[h]}function v(l){const{slug:h}=e.teasers[l],z=`/projects/${h}`;window.location.pathname!==z&&window.history.replaceState({scroll:l},"",`/projects/${h}`)}function d(l){return{content:"",released:l.released,slug:l.slug,title:l.title}}let n=w(()=>Math.round(a(i))),g=w(()=>e.teasers[a(n)-1]?.slug),p=w(()=>e.teasers[a(n)]?.slug),o=w(()=>e.teasers[a(n)+1]?.slug);P(()=>{a(g)&&u(a(g))}),P(()=>{a(p)&&u(a(p))}),P(()=>{a(o)&&u(a(o))});let b=w(()=>[a(n)-1,a(n),a(n)+1].filter(l=>l>=0&&l<e.teasers.length&&l!==t));P(()=>{v(a(n))});var m=at(),c=j(m);{let l=w(()=>e.teasers.length-1);tt(c,{get max(){return a(l)},get value(){return a(i)},set value(h){ce(i,h,!0)}})}var _=N(c,2),y=H(_);Le(y,16,()=>a(b),l=>l,(l,h)=>{{let z=w(()=>a(i)-h);ae(l,{get scroll(){return a(z)},children:(Z,O)=>{var k=q(),ge=j(k);Je(ge,()=>r[h],T=>{{let I=w(()=>d(e.teasers[h]));M(T,{get project(){return a(I)}})}},(T,I)=>{var G=q(),be=j(G);{var _e=S=>{M(S,{get project(){return a(I)}})},pe=S=>{{let we=w(()=>d(e.teasers[h]));M(S,{get project(){return a(we)}})}};V(be,S=>{a(I)?S(_e):S(pe,!1)})}x(T,G)}),x(Z,k)},$$slots:{default:!0}})}});var ve=N(y,2);{var me=l=>{{let h=w(()=>a(i)-t);ae(l,{get scroll(){return a(h)},children:(z,Z)=>{var O=q(),k=j(O);U(k,()=>e.children),x(z,O)},$$slots:{default:!0}})}};V(ve,l=>{t>a(n)-2&&t<a(n)+2&&l(me)})}Y(_);var E=N(_,2);E.__mousedown=()=>{Ze.set("right")};var he=H(E);Ge(he,{href:"/portfolio",type:"previous",children:(l,h)=>{Ce();var z=xe("Portfolio");x(l,z)},$$slots:{default:!0}}),Y(E),ee(5,_,()=>Xe,()=>({})),ee(6,_,()=>$e,()=>({})),x(s,m),D()}Ye(["mousedown"]);function pt(s,e){B(e,!0),nt(s,{get teasers(){return e.data.teasers},children:(t,r)=>{var i=q(),f=j(i);U(f,()=>e.children??ue),x(t,i)},$$slots:{default:!0}}),D()}export{pt as component};
