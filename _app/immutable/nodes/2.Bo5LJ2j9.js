import{t as Y,a as z,c as C}from"../chunks/DqkE_y2J.js";import{h as O,d as Se,b as Ie,aG as je,a5 as Q,O as q,z as V,q as B,N as ke,l as Pe,ak as $,aj as ee,aH as te,X as Ne,o as re,v as R,ac as Ce,R as Ee,T as He,S as Te,aI as Ae,a1 as Oe,p as E,u as w,t as le,a as H,g as s,a6 as qe,c as ue,n as L,r as fe,ag as se,a2 as Be,W as P,f as I,a3 as Re,s as ne}from"../chunks/5bxpvR_4.js";import{s as W}from"../chunks/gJKSPmBw.js";import{i as ae}from"../chunks/-kk17F26.js";import{e as De}from"../chunks/Dm9FQRwy.js";import{p as Ge,f as Me,a as de,s as ve}from"../chunks/CNUIBfIj.js";import{p as Ue}from"../chunks/Bc4lfOry.js";import{P as D}from"../chunks/CQ1-HF2C.js";import{s as me}from"../chunks/Dxr2MA7t.js";import{o as Ye}from"../chunks/C3uF77Tp.js";import{w as he}from"../chunks/YhocaKZe.js";const G=0,N=1,M=2;function Le(a,r,n,o,v){O&&Se();var i=a,u=Ne,l=Q,f,c,m,x=V(void 0),t=V(void 0),h=!1;function _(p,b){h=!0,b&&($(d),ee(d),te(u));try{p===G&&n&&(f?re(f):f=B(()=>n(i))),p===N&&o&&(c?re(c):c=B(()=>o(i,x))),p!==G&&f&&R(f,()=>f=null),p!==N&&c&&R(c,()=>c=null),p!==M&&m&&R(m,()=>m=null)}finally{b&&(te(null),ee(null),$(null),Ce())}}var d=Ie(()=>{if(l!==(l=r())){if(je(l)){var p=l;h=!1,p.then(b=>{p===l&&(q(x,b),_(N,!0))},b=>{if(p===l)throw q(t,b),_(M,!0),t.v}),O?n&&(f=B(()=>n(i))):ke(()=>{h||_(G,!0)})}else q(x,l),_(N,!1);return()=>l=Q}});O&&(i=Pe)}function We(a,r,n){Ee(()=>{var o=He(()=>r(a,n==null?void 0:n())||{});if(n&&(o!=null&&o.update)){var v=!1,i={};Te(()=>{var u=n();Ae(u),v&&Oe(i,u)&&(i=u,o.update(u))}),v=!0}if(o!=null&&o.destroy)return()=>o.destroy()})}var Xe=Y('<div class="scroller"></div>');function Ze(a,r){E(r,!0);let n=Ge(r,"value",15),o=w(()=>r.max);n()!==0&&Ye(()=>{window.scrollTo(0,document.body.scrollHeight*(n()/s(o)))});function v(){const l=window.scrollY/(document.body.offsetHeight-window.innerHeight);n(l*s(o))}var i=Xe();Me("scroll",qe,v);let u;le(()=>u=me(i,"",u,{height:`${s(o)*100}vh`})),z(a,i),H()}function U(a,r){let n=oe(r),o,v,i=!0;function u({box:f}){o=new ResizeObserver(([c])=>{let m;f==="border-box"?m=c.borderBoxSize:f==="device-pixel-content-box"?m=c.devicePixelContentBoxSize:m=c.contentBoxSize,n.set(Array.isArray(m)?m[0]:m),i=!1}),o.observe(a,{box:f}),v=n.subscribe(c=>{i||a.dispatchEvent(new CustomEvent("has-resized",{detail:c}))})}function l(){o.disconnect(),v()}return u(ie(r)),{update(f){i=!0,n=oe(f),l(),u(ie(f))},destroy(){l()}}}function oe(a){if(typeof a=="object"){if(a.subscribe)return a;if(a.store)return a.store}return he({inlineSize:0,blockSize:0})}function ie(a){if(typeof a>"u"||a.subscribe)return{};const{store:r,...n}=a;return n}var Fe=Y('<div class="item svelte-hrs2h8"><!></div>');function ce(a,r){E(r,!0);const[n,o]=ve(),v=()=>de(u,"$size",n),i=16,u=he({inlineSize:0,blockSize:0});function l(t,h){const _=window.innerHeight,d=_/2;if(t>1)return-h;if(t<-1)return _;if(t>.5){const b=(t-.5)*2;return-h+d-d*b}if(t<-.5){const b=(t+1.5)*2-1;return _-d*b}const p=t+.5;return d-h*p}function f(t,h){if(h===0)return"";let _=1;if(t>.75&&t<1){const d=(t-.75)*4;_=1-d*d*.2}if(t<-.5&&t>-1){const d=(t+.5)*-2;_=1-d*d*.3}return`translateY(${l(t,h+i)}px) scale(${_})`}var c=Fe();let m;var x=ue(c);W(x,()=>r.children??L),fe(c),We(c,(t,h)=>U==null?void 0:U(t,h),()=>u),le(t=>m=me(c,"",m,{transform:t}),[()=>f(r.scroll,v().blockSize)]),z(a,c),H(),o()}var Je=Y('<!> <div class="viewport svelte-1hdbnwf"><!> <!></div>',1);function Ke(a,r){E(r,!0);const[n,o]=ve(),i=f(de(Ue,"$page",n).params.project),u=se({});let l=Be(se(i));function f(e){return r.teasers.findIndex(g=>g.slug===e)}function c(e){const g=f(e);return u[g]||(u[g]=fetch(`/projects/${e}.json`).then(y=>y.json())),u[g]}function m(e){const{slug:g}=r.teasers[e],y=`/scrollytelling/${g}`;window.location.pathname!==y&&window.history.pushState({scroll:e},"",`/scrollytelling/${g}`)}function x(e){return{content:"",released:e.released,slug:e.slug,title:e.title}}let t=w(()=>Math.round(s(l))),h=w(()=>{var e;return(e=r.teasers[s(t)-1])==null?void 0:e.slug}),_=w(()=>{var e;return(e=r.teasers[s(t)])==null?void 0:e.slug}),d=w(()=>{var e;return(e=r.teasers[s(t)+1])==null?void 0:e.slug});P(()=>{s(h)&&c(s(h))}),P(()=>{s(_)&&c(s(_))}),P(()=>{s(d)&&c(s(d))});let p=w(()=>[s(t)-1,s(t),s(t)+1].filter(e=>e>=0&&e<r.teasers.length&&e!==i));P(()=>{m(s(t))});var b=Je(),X=I(b);const _e=w(()=>r.teasers.length-1);Ze(X,{get max(){return s(_e)},get value(){return s(l)},set value(e){Re(l,e,!0)}});var Z=ne(X,2),F=ue(Z);De(F,16,()=>s(p),e=>e,(e,g)=>{const y=w(()=>s(l)-g);ce(e,{get scroll(){return s(y)},children:(J,T)=>{var j=C(),be=I(j);Le(be,()=>u[g],A=>{const k=w(()=>x(r.teasers[g]));D(A,{get project(){return s(k)}})},(A,k)=>{var K=C(),we=I(K);{var xe=S=>{D(S,{get project(){return s(k)}})},ye=S=>{const ze=w(()=>x(r.teasers[g]));D(S,{get project(){return s(ze)}})};ae(we,S=>{s(k)?S(xe):S(ye,!1)})}z(A,K)}),z(J,j)},$$slots:{default:!0}})});var ge=ne(F,2);{var pe=e=>{const g=w(()=>s(l)-i);ce(e,{get scroll(){return s(g)},children:(y,J)=>{var T=C(),j=I(T);W(j,()=>r.children??L),z(y,T)},$$slots:{default:!0}})};ae(ge,e=>{i>s(t)-2&&i<s(t)+2&&e(pe)})}fe(Z),z(a,b),H(),o()}function ct(a,r){E(r,!0),Ke(a,{get teasers(){return r.data.teasers},children:(n,o)=>{var v=C(),i=I(v);W(i,()=>r.children??L),z(n,v)},$$slots:{default:!0}}),H()}export{ct as component};
